#!/usr/bin/env node
require('dotenv').config()
var QuickbooksServer = require('../index');
var quickbooksServer = new QuickbooksServer();
var qbXMLHandler = require('./qbXMLHandler');
var mongoUtils = require('../lib/mongoUtil');

async function main() {
  await mongoUtils.getDb();
  quickbooksServer.setQBXMLHandler(qbXMLHandler);
  quickbooksServer.run();
  process.on('SIGINT', async () => {
    await mongoUtils.closeConnection();
    console.log('MongoClient successfully disconnected');
    process.exit(0);
  })
}

main();
